# 5. 함수와 이벤트

## 함수를 정의하고 실행하기

프로그램을 작성하면서 필요한 기능, 특히 자주 사용할 것 같은 기능은 그 기능에 필요한 명령을 사용자가 직접 묶어서 함수로 만들 수 있다.

프로그램에서는 함수가 어떤 명령을 처리해야 할지 미리 알려주는 것을 **'함수 선언'** 이라 하고, 선언한 함수를 가져와 사용하는 것을 **'함수 실행'** 이라고 한다.

함수를 선언 할때는 function 예약어를 사용하고, 중괄호({}) 안에 함수에서 실행할 여러 명령을 묶는다.

```javascript
function addNumber() {
    var sum = 10 + 20;
    console.log(sum);
}
```

함수를 선언 했지만 함수를 실행하려면 함수를 실행하는 소스가 따로 필요하다.

```javascript
addNumber(); // 30
```

선언한 함수를 실행하기 위해서는 위와 같이 함수 이름을 이용하며, 이를 **'함수를 호출한다'** 라고 한다.

#### 함수 선언과 실행 순서

웹 브라우저에서 자바스크립트 소스를 해석할 때 함수 선언 부분을 가장 먼저 해석한다. 그래서 개발자가 원하는 어느 곳이든 함수를 선언해 놓기만 하면, 선언한 위치와 상관없이 함수를 실행할 수 있다. 

```javascript
// 함수 호출 소스를 선언 소스 앞에 작성한 예시
addNumber();

function addNumber(){
    ......
}
    
// 함수 호출 소스를 선언 소스 뒤에 작성한 예
function addNumber(){
    ......
}
    
addNumber();
```

즉 함수 선언 위치는 프로그램 흐름에 영향을 주지 않는다. 그래서 보통 한 문서 안에 여러 함수를 선언했을때 스크립트 소스의 앞부분이나 뒷부분에 함수 선언 소스를 모아 놓고 필요할 때마다 함수를 호출한다.

## let과 const로 변수 선언하기

자바스크립트 ES6 버전에서는 변수를 선언하기 위해 let와 const라는 새로운 예약어가 생겼다.

#### 변수의 적용 범위 알아보기

자바스크립트에서 변수를 선언하고 사용할 때 변수가 적용되는 범위를 **스코프(scope)** 라고 한다. 변수가 어디까지 유효한지 그 범위를 가리키는 영역이 있다. 자바스크립트 함수에서 변수를 사용할 떄는 이 영역에 주의해야한다.

한 함수안에서만 사용하고 다른 함수에서는 사용할 수 없는 변수가 있는가 하면, 어느 함수에서나 다 사용할 수 있는 변수가 있다. 

한 함수 안에서만 사용할 수 있는 변수를 **지역변수** 또는 **로컬 변수**라고 하고, 스크립트 소스 전체에서 사용할 수 있는 변수를 **전역변수** 또는 **글로벌 변수**라고 한다.

#### 함수 안에서만 쓸 수 있는 지역변수

지역 변수는 함수 안에서 선언하고 함수 안에서만 사용한다. 함수를 선언할 때 지역변수를 선언하려면 예약어 var와 함께 변수 이름을 지정해야 한다. 만약 변수 이름 앞에 var가 없다면 함수 안에서 선언했어도 전역 변수로 취급되니 주의해야한다.

```javascript
var myVar = 100; // 전역 변수
test();
document.write("my var is " + myVar);

function test(){
    var myVar = 50; // 지역 변수
}
```

test() 함수 밖에 변수 myVar 100이 선언되어 있고, test() 함수 안에 변수 myVar가 50으로 다시 선언되어 있다. 함수 안에 있는 변수 myVar 앞에는 예약어 var를 함께 선언했기 때문에 함수 안에서만 사용할 수 이는 지역변수이다. 즉 test() 함수 안에서는 변수 myVar에 50이 할당 되지만 test() 함수를 벗어나면 그 값은 무효가 된다. 따라서 결과 값으로 웹 브라우저 화면에 myVar의 값이 100으로 표시된다.

지역 변수는 전역 변수에 영향을 주지 않는다. 하지만 전역 변수와 지역 변수가 이름이 같다면 나중에 헷갈릴 수 있으므로 변수 이름은 겹치지 않게 하는 것이 좋다.

#### 스크립트 안에서 자유롭게 쓸 수 있는 전역 변수

전역 변수란 스크립트 소스 전체에서 사용할 수 있는 변수를 말한다. 이는 변수를 한 번 선언하고 나면 그 값을 계속해서 유지한다는 뜻이다. 만일 함수 안에서 새롭게 전역 변수를 선언하려면 변수 이름 앞에 var 예약어를 사용하지 않으면 된다.

```javascript
var myVar = 100; // 전역 변수
test();
document.write("my var is " + myVar);

function test(){
    myVar = 50; // 전역 변수
}
```

test() 함수 안에서 myVar 변수에 var 예약어를 붙이지 않았다. 이 경우에는 test() 함수 안에 있는 myVar 변수는 전역 변수가 된다. 그래서 연결된 문서를 웹 브라우저에서 열어보면 myVar 값이 50으로 표시된다.

#### var를 사용한 변수의 특징

자바스크립트에서 var 변수를 사용할 때 **호이스팅**을 조심해야한다. 호이스팅이란 '끌어올리다'를 뜻하는데, 상황에 따라 변수의 선언과 할당을 분리해서 선언 부분을 스코프의 가장 위쪽으로 끌어올리는 것이다. 끌어올린다고 해서 실제로 소스 코드를 끌어올리는 것은 아니고 소스를 그런 식으로 해석한다는 의미이다.

```javascript
var x = 100;

test();

function test(){
    document.write(`x is ${x}, y is ${y}`);
    var y = 200;
}
```

이를 웹 브라우저에서 확인 해보면 x의 변수값은 100 이지만 y의 변수값은 자료형인 undefined로 나타나게 된다. 

이러한 결과가 나타난 것이 바로 **변수 호이스팅** 때문이다. 자바스크립트 해석기는 함수 소스를 훑어보면서 var 변수를 따로 기억해둔다. 즉, 변수를 실행하기 전이지만 '이런 변수가 있구나'하고 기억해 두기 때문에 마치 선언한 것과 같은 효과가 있는 것이다. var 변수는 호이스팅이 있기 때문에 변수를 선언하기 전에 사용해도 오류가 생기지 않고, 그로 인해 예상하지 못한 결과가 나올 수 있다.

**var 키워드를 사용한 변수는 호이스팅 외에도 재선언이 가능하다는 단점이 있다.** 변수 재선언이란 한 번 선언한 변수를 다시 선언할 수 있다는 뜻이다. 팀 프로젝트를 진행할 경우 여러 명이 작성한 프로그램을 서로 합치거나 연결해서 사용하게 된다. 이 때 혹시라도 같은 변수 이름을 사용해서 선언한 부분이 있다면 이전의 변수를 덮어쓰기 때문에 예상치 못한 결과가 생기게 된다.

#### let과 constant를 사용한 변수의 특징

앞에서 살펴본 것 처럼 var 예약어를 빠뜨리면 의도하지 않게 전역 변수가 되기도 하고, 프로그램 길이가 길어지다 보면 실수로 변수를 재선언하거나 값을 재할당해 버리는 경우가 생기기도 한다. 그래서 **그래서 ES6에서는 변수를 선언하기 위한 예약어로 let와 const가 추가 되었고, 되도록이면 let 예약어를 사용할 것을 권장한다.**

**var과 let, const의 가장 큰 차이는 스코프의 범위이다. var는 함수 영역의 스코프를 가지지만 let와 const는 블록 영역의 스코프를 가진다.**  let과 const를 사용한 변수의 특징을 하나씩 살펴보도록 하자.

##### *블록 안에서만 쓸 수 있는 변수

let 예약어로 선언한 변수는 변수를 선언한 블록에서만 유효하고 블록을 벗어나면 사용할 수 없다.

```javascript
function calcSum(n){
    let sum = 0;
    for(let i = 1; i<n+1; i++){
        sum += i;
    }
    console.log(sum);
}

calcSum(10); // 55
```

calcSum() 함수에서 변수 sum은 let 예약어를 사용하여 선언했따. 즉, sum은 calcSum의 블록({}) 안에서만 사용할 수 있다. 또한 for문의 카운터 변수 i도 let 예약어를 사용했다. 변수 i는 for문을 벗어나면 사용할 수 없다.

만약 전역변수를 선언하고 싶다면 let 예약어를 쓰지 않고 변수 이름과 초깃값만 할당하면 된다.

##### *재할당은 가능하지만 재선언은 할 수 없는 변수

let예약어를 사용하여 선언한 변수는 값을 재할당할 수 는 있지만 변수를 재선언할 수는 없다. 그러니 예약어 var와 같이 실수로 같은 변수의 이름을 사용할 걱정이 없다.

```javascript
function calcSum(n){
    let sum = 0;
    for(let i = 1; i<n+1; i++){
        sum += i;
    }
    let sum; // 변수 재선언  Uncaught SyntaxError: Identifier 'sum' has alread been declared
    console.log(sum);
}

calcSum(10); 
```

##### *호이스팅이 없는 변수

호이스팅 때문에 var 예약어를 사용한 변수는 선언하기 전에 실행하더라도 오류도 생기지 않고 undefined값을 가질 수 있다. **하지만 let 예약어를 사용한 변수는 선언하기 전에 사용할 경우 오류 메시지를 나타낸다.**

```javascript
var x = 100;

test();

function test() { 			
	document.write("x is " + x + ", y is " + y); // 블록 변수 y를 선언하기 전에 사용
  	let y = 200;                                 // Uncaught ReferenceError: Cannot access 'y' before 														 //	initializaiotn
}
```

##### *const 변수

const로 선언한 변수는 **상수**이다. 상수는 프로그램 안에서 변하지 않는 값을 뜻한다. 즉, 변하지 않는 값을 변수로 선언할 때 const 예약어를 사용한다.

**const로 할당한 변수는 재선언하거나 재할당할 수 없으며, let 예약어를 사용한 변수처럼 블록 레벨의 스코프를 가진다.**

## 자바스크립트 변수, 이렇게 사용하세요

#### 1. 전역 변수는 최소한으로 사용한다.

전역 변수는 프로그램 어디서든 접근할 수 있으므로 편리하게 사용할 수 있다. 하지만 그만큼 오류가 발생할 확률이 높아지므로 전역 변수는 되도록 적게 사용하는 것이 좋다.

#### 2. var 변수는 함수의 시작 부분에 선언한다.

var를 사용한 변수는 어디서든 선언하든 상관 없지만 내부에서 호이스팅이 생기므로 오류가 발생할 수 있다. 그래서 var 변수는 함수 시작 부분에 선언하는 것이 변수를 확인하기도 쉽고 오류도 줄이는 방법이다.

#### 3. for문에서 카운터 변수를 사용할 때는 블록 변수를 사용하는 것이 좋다.

for문 안에서만 사용할 카운터 변수는 그 블록 안에서만 사용할 것이므로 가끔 var를 사용해서 선언하기도 한다. 하지만 이렇게 선언한다고 해서 블록 변수가 되는 것이 아니다. var 변수는 함수 레벨의 스코프이다. 따라서 for문의 카운터 변수는 for문 밖에 선언하거나 아예 let을 사용해서 블록 변수로 선언하는 것이 좋다.

```javascript
// 블록 밖에서 var로 선언
var i;
for(i=1; i<=n; i++){
    ...
}

// let을 사용해서 블록 변수로 선언
for(let i = 1; i<=n; i++){
    ...
}
```

#### 4. ES6를 사용한다면 예약어 var 보다 let을 사용하는 것이 좋다.

var을 사용한 변수는 호이스팅이 일어나고 실수로 재선언할 수도 있기 떄문에 프로그램에서 예상하지 못한 오류를 만들 수 있다. 호이스팅이 없고 재선언할 수 없는 let을 사용하는 것이 더 안전하다.

## 여러 번 사용할 수 있는 함수 만들기

한 번만 사용하고 말 함수라면 상관 없지만, 프로그램 안에서 여러 번 사용할 함수라면 입력 값을 바꾸지 못한다는 건 매우 불편한 일이다. 그래서 함수를 잘 활용하기 위해서는 여러 입력값을 넣을 수 있게 만들어야 한다.

이렇게 입력을 바꿔 여러 번 사용할 수 있는 성질을 함수의 **'재사용성'** 이라고 한다.

#### 함수의 매개변수와 인수 소개

재사용이 가능한 두 수를 더하는 함수 addNumber()를 선언하기 위해서는 '값 2개가 필요하다'고 미리 지정해 두어야 한다. 이렇게 함수를 실행하기 위해 필요하다고 지정하는 값을 **매개변수**라고 한다. 매개변수는 함수를 실행하는 데 필요한 '입력'이라고 생각하면 된다.

```javascript
function addNumber(a,b){ // a,b는 매개변수
    var sum = a+b;
    console.log(sum);
}
```

매개변수가 있는 함수를 실행할 때는 함수 이름 옆의 괄호 안에 매개변수에 할당할 값을 넣어준다. 여기에서 만든 addNumber() 함수는 매개변수가 2개이므로 addNumber() 함수를 실행할 때 괄호 안에 두 값을 넣어 준다. 

이렇게 함수를 실행할 때 매겨변수로 넘겨주는 값을 **인수**라고 한다.

```javascript
addNumber(2,3); // 2와 3은 인수
```

##### -함수의 매개변수 기본 값 지정하기

ES6에는 매개변수가 있는 함수를 선언할 때 매개변수의 기본 값을 지정하는 기능도 생겼다.

```javascript
function multiple(a, b=5, c=10){ // b=10, c=20 기본 값 지정
    return a*b+c;
}
multiple(5, 10, 20); // a=5, b=10 c=20
multiple(10, 20);    // a=10, b=20, c=10(기본 값)
multiple(5);		 // a=5, b=5(기본 값), c=10(기본 값)
```

#### 함수의 return문 더 알아보기

함수를 실행한 후 그 결괏값을 함수 밖으로 넘기는 것을 '함숫값을 반환한다.' 라고 한다. 반환 위치는 함수를 호출한 위치이다. 함수 결괏값을 반환할 때는 return 예약어 다음에 넘겨줄 값이나 변수 또는 식을 지정한다.

## 함수 표현식

함수를 선언한 후 이름을 사용해 실행하는 것이 기본 방법이지만, 이 외에도 함수를 실행하는 방법이 있다. 이런 방법을 **'함수 표현식'**이라고 한다.

#### 익명 함수

'익명 함수'는 이름에서도 알 수 있듯이 이름이 없는 함수를 말한다. 익명 함수를 선언할 때는 이름을 붙이지 않는다. 익명 함수는 함수 자체가 식이기 때문에 익명 함수를 변수에 할당할 수 있다. 또한 다른 함수의 매개변수로 사용할 수도 있다.

```javascript
var add = function(a,b){ // 함수 선언 후 변수 add에 할당
    return a+b;
}
```

이제 선언한 익명 함수를 샐행해보자. 기존의 함수는 함수 이름을 사용해서 실행했다. 하지만 익명 함수는 이름이 없다. 따라서 앞에서 선언한 익명 함수를 변수 add에 선언했으므로 이 변수 add를 함수 이름처럼 사용해서 익명 함수를 실행한다.

```javascript
var sum = add(10, 20); // 익명 함수 실행 후 결괏값을 변수 sum에 저장
```

#### 즉시 실행 함수

함수를 식으로 표현하는 또 다른 방식은 **'즉시 실행 함수'** 이다. 즉시 실행 함수는 함수를 정의함과 동시에 실행하는 함수이다. 

즉시 실행 함수는 함수 선언 소스 전체를 괄호로 묶는다고 생각하면 쉽다. 그리고 소스를 닫는 괄호 앞이나 뒤에 인수가 들어갈 괄호를 넣는다. 즉시 실행 함수는 식이기 때문에 소스 끝에 세미콜론(;)을 붙여준다.

```javascript
(function(){
    
})();

(function(){
    
}());
```

즉시 실행 함수는 변수에 할당할 수 있고, 함수에서 반환하는 값을 변수에 할당할 수도 있다. 

```javascript
var result = (function(){
  return 10+20;  
}());

console.log(result); // 30
```

#### 화살표 함수

ES6 버전부터는 => 표기법(화살표 표기법)을 사용해 함수 선언을 더 간단하게 작성할 수 있다. 이 방법은 간단히 화살표 함수라고 하는데 익명 함수에서만 사용할 수 있다. 매개변수에 따라 함수를 작성하는 방법을 간단히 살펴보도록 한다.

##### -매개변수가 없을때 =>로 함수 선언하기

매개변수가 없을 때는 매개 변수가 들어가는 괄호 안을 비워둔다.

```javascript
const hi = function(){
    return "안녕하세요?";
}

// 화살표 표기법
const hi = () => {return "안녕하세요?"};

// 중괄호 안에 함수 내용이 한 줄 뿐이라면 중괄호를 생략해서 다음과 같이 작성할 수도 있다.
const hi = () => "안녕하세요?";
```

##### -매개변수가 1개일 때 =>로 함수 선언하기

매개변수가 하나일 경우 매개변수의 괄호를 생략해서 다음과 같이 표현할 수 있다.

```javascript
let hi = function(user){
    document.write(user + "님, 안녕하세요?");
}

// 화살표 표기법
let hi = user => document.write(user + " 님, 안녕하세요?");
```

##### -매개변수가 2개 이상일 때 =>로 함수 선언하기

매개변수가 2개인 함수를 화살표 함수로 바꾸려면 (매개변수) => {...}처럼 사용하고, 괄호 안에 매개변수를 쉼표로 구분해서 넣는다. 중괄호 안에 식이 하나이면 return문을 생략할 수 있다.

```javascript
let sum = function(a,b){
    return a+b;
}

// 화살표 표기법
let sum = (a,b) => {return a+b}

// 중괄 호 안에 함수 내용이 한 줄이므로 return문과 중괄호 생략.
let sum = (a,b) => a+b;
```

## 이벤트 다루기

이벤트란 웹 브러우저나 사용자가 행하는 어떤 동작을 말한다. 이벤트는 웹 페이지를 읽어 오거나 링크를 누르는 것처럼 웹 문서 영역 안에서 이루어지는 동작만을 말한다. 따라서 사용자가 웹 문서 영역을 벗어나 누르는 행위는 이벤트가 아니다.	

자바스크립트 이벤트는 주로 마우스나 키보드를 사용할 때, 웹 문서를 불러올 때, 폼에 내용을 입력할 때 주로 발생한다.

#### 마우스 이벤트

마우스 이벤트는 마우스에서 버튼이나 휠 버튼을 조작할 때 발생하는 이벤트이다.

|   속성    |                             설명                             |
| :-------: | :----------------------------------------------------------: |
|   click   |  사용자가 HTML 요소를 마우스로 눌렀을 때 이벤트가 발생한다.  |
|  dbclick  | 사용자가 HTML 요소를 마우스로 두 번 눌렀을 때 이벤트가 발생한다. |
| mousedown | 사용자가 요소 위에서 마우스 버튼을 누르는 동안 이벤트가 발생한다. |
| mousemove | 사용자가 요소 위에서 마우스 포인터를 움직일 때 이벤트가 발생한다. |
| mouseover |    마우스 포인터가 요소 위로 옮겨질 때 이벤트가 발생한다.    |
| mouseout  |     마우스 포인터가 요소를 벗어날 때 이벤트가 발생한다.      |
|  mouseup  | 사용자가 누르고 있던 마우스 버튼에서 손을 뗄 때 이벤트가 발생한다. |

#### 키보드 이벤트

키보드 이벤트는 키보드에서 특정 키를 조작할 때 발생하는 이벤트이다.

|   속성   |                     설명                      |
| :------: | :-------------------------------------------: |
| keypress |  사용자가 키를 눌렀을 때 이벤트가 발생한다.   |
| keydown  | 사용자가 키를 누르는 동안 이벤트가 발생한다.  |
|  keyup   | 사용자가 키에서 손을 뗄 때 이벤트가 발생한다. |

#### 문서 로딩 이벤트

서버에서 웹 문서를 가져오거나 문서를 위아래로 스크롤하는 등 웹 문서를 브라우저 창에서 보여 주는 것과 관련된 이벤트이다.

|  속성  |                             설명                             |
| :----: | :----------------------------------------------------------: |
| abort  | 웹 문서가 완전히 로딩되기 전에 불러오기를 멈췄을 때 이벤트가 발생한다. |
| error  |     문서가 정확히 로딩되지 않았을 때 이벤트가 발생한다.      |
|  load  |            문서 로딩이 끝나면 이벤트가 발생한다.             |
| resize |       문서 화면 크기가 바뀌었을 때 이벤트가 발생한다.        |
| scroll |        문서 화면이 스크롤되었을 때 이벤트가 발생한다.        |
| unload |             문서를 벗어날 때 이벤트가 발생한다.              |

#### 폼 이벤트

폼(form)이란 로그인이나 검색, 게시판, 설문 조사처럼 사용자가 자료(정보)를 입력하는 모든 요소를 가리킨다. 다음은 폼 요소에 내용을 입력하면서 발생할 수 있는 여러 이벤트이다.

|  속성  |                             설명                             |
| :----: | :----------------------------------------------------------: |
|  blur  |       폼 요소에 포커스를 잃었을 때 이벤트가 발생한다.        |
| change | 목록이나 체크 상태 등이 변경되었을 대 이벤트가 발생한다.(<input>,<select>,<textarea>태그에서 사용한다.) |
| focus  | 폼 요소에 포커스가 놓였을 때 이벤트가 발생한다.(<label>, <select>, <textarea>, <button> 태그에서 사용한다.) |
| reset  |          폼이 다시 시작되었을 때 이벤트가 발생한다.          |
| submit |          submit 버튼을 눌렀을 때 이벤트가 발생한다.          |

#### 이벤트 처리기

대부분의 웹 사이트에서는 사용자가 어떤 동작을 하면, 즉 이벤트가 발생하면 연결 동작이 뒤따른다.

이를 위해서는 웹 문서에서 이벤트가 발생했을 때 어떤 함수를 실행해야 할지 웹 브라우저에 알려주어야 한다. 이때 이벤트와 이벤트 처리 함수를 연결해주는 것을 **'이벤트 처리기'** 또는 **'이벤트 핸들러'** 라고 한다. 이벤트 처리기는 이벤트 이름 앞에 on을 붙여서 사용한다. 예를 들어 click 이벤트가 발생했을 때 이벤트 처리기는 onclick 다음에 있는 실행 명령이나 함수를 연결한다.

## QUIZ

1. 매개변수 두 개를 받아 두 값이 같다면 두 변수를 곱하고, 값이 같지 않다면 두 수를 더하는 함수 sumMulti를 작성하세요. 그리고 값 5와 10을 sumMulti 함수로 넘겨 실행했을 때와 10과 10을 sumMulti 함수로 넘겨 실행했을 때 결괏값을 콘솔 창에 표시하세요.
2. 프롬프트 창에서 두 숫자를 입력받은 후 그 값을 넘겨주면 두 숫자 크기를 비교해 더 큰 숫자를 알림 창에 표시하는 함수를 작성하고 실행하세요.
